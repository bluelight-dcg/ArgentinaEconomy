<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gráfico de Barras</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="filter-container">
  <label for="mes" class="filter-label">Mes:</label>
  <select id="mes" class="filter-select">
    <option value="Jan/00">Enero</option>
    <option value="Feb/00">Febrero</option>
    <option value="Mar/00">Marzo</option>
    <option value="Apr/00">Abril</option>
  </select>

  <label for="representante" class="filter-label">Representante:</label>
  <select id="representante" class="filter-select">
    <option value="Francisco">Francisco</option>
    <option value="Marcos">Marcos</option>
    <option value="Mariano">Mariano</option>
    <option value="Barbara">Barbara</option>
  </select>

  <label for="tipoPorcentaje" class="filter-label">Tipo de Porcentaje:</label>
  <select id="tipoPorcentaje" class="filter-select">
    <option value="Tiempo de respuesta">Tiempo de respuesta</option>
    <option value="Presentismo">Presentismo</option>
    <option value="Nota capacitación">Nota capacitación</option>
    <option value="Satisfacción del cliente">Satisfacción del cliente</option>
  </select>
</div>

<canvas id="graficoBarras"></canvas>

<script>
// Datos completos (puedes incluirlos directamente aquí o cargarlos desde un archivo externo)
var datos = [
  // Aquí van tus datos
];

// Función para filtrar los datos
function filtrarDatos() {
  var mesSeleccionado = document.getElementById("mes").value;
  var representanteSeleccionado = document.getElementById("representante").value;
  var tipoPorcentajeSeleccionado = document.getElementById("tipoPorcentaje").value;

  return datos.filter(function(dato) {
    return dato.includes(mesSeleccionado) && dato.includes(representanteSeleccionado) && dato.includes(tipoPorcentajeSeleccionado);
  });
}

// Función para obtener los valores a graficar
function obtenerValores() {
  var datosFiltrados = filtrarDatos();
  var valores = [];

  datosFiltrados.forEach(function(dato) {
    var celdas = dato.split("\t");
    valores.push(parseFloat(celdas[2])); // Cambiar el índice según el tipo de porcentaje que quieras graficar
  });

  return valores;
}

// Función para obtener las etiquetas del eje X
function obtenerEtiquetas() {
  var datosFiltrados = filtrarDatos();
  var etiquetas = [];

  datosFiltrados.forEach(function(dato) {
    var celdas = dato.split("\t");
    etiquetas.push(celdas[1]); // Cambiar el índice según el tipo de porcentaje que quieras graficar
  });

  return etiquetas;
}

// Crear el gráfico de barras
var ctx = document.getElementById("graficoBarras").getContext("2d");
var myChart = new Chart(ctx, {
  type: 'bar',
  data: {
    labels: obtenerEtiquetas(),
    datasets: [{
      label: 'Porcentaje', // Cambiar la etiqueta según el tipo de porcentaje que estés graficando
      data: obtenerValores(),
      backgroundColor: 'rgba(54, 162, 235, 0.5)', // Color de las barras
      borderColor: 'rgba(54, 162, 235, 1)',
      borderWidth: 1
    }]
  },
  options: {
    scales: {
      yAxes: [{
        ticks: {
          beginAtZero: true
        }
      }]
    }
  }
});

// Volver a actualizar el gráfico al cambiar algún filtro
document.getElementById("mes").addEventListener("change", function() {
  myChart.data.labels = obtenerEtiquetas();
  myChart.data.datasets[0].data = obtenerValores();
  myChart.update();
});

document.getElementById("representante").addEventListener("change", function() {
  myChart.data.labels = obtenerEtiquetas();
  myChart.data.datasets[0].data = obtenerValores();
  myChart.update();
});

document.getElementById("tipoPorcentaje").addEventListener("change", function() {
  myChart.data.labels = obtenerEtiquetas();
  myChart.data.datasets[0].data = obtenerValores();
  myChart.update();
});
</script>

</body>
</html>
